{
  "specialist": "viz",
  "domain": "hospitality",
  "cells": [
    {
      "cell_type": "markdown",
      "content": "# 서울 에어비앤비 RevPAR EDA 시각화\n\n**분석 목적:** 서울 에어비앤비 데이터를 바탕으로 호스트 관점(물건 특성별 RevPAR 분포)과 플랫폼 관점(자치구별 RevPAR 패턴)을 탐색적으로 시각화합니다.\n\n**데이터 개요:**\n- 총 32,061 rows × 42 cols\n- 핵심 지표: `ttm_revpar` (TTM RevPAR, 왜도=3.76), `l90d_revpar` (최근 90일 RevPAR, 왜도=3.86)\n- 주요 필터: `refined_status == 'Active'` AND `operation_status == 'Operating'` (Active+Operating)\n\n**시각화 구성:**\n1. RevPAR 분포 분석\n2. room_type별 RevPAR\n3. superhost 효과\n4. 사진수 vs RevPAR\n5. 평점 vs RevPAR\n6. 자치구별 RevPAR\n7. POI 거리 vs RevPAR\n8. 자치구별 점유율 vs 가격\n9. operation_status 분포"
    },
    {
      "cell_type": "code",
      "content": "# 공통 라이브러리 임포트 및 데이터 로드\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport matplotlib.ticker as mticker\nimport seaborn as sns\nimport warnings\n\nwarnings.filterwarnings('ignore')\n\n# 한글 폰트 설정 (macOS AppleGothic)\nplt.rc('font', family='AppleGothic')\nplt.rc('axes', unicode_minus=False)\n\n# seaborn 스타일 설정\nsns.set_style('whitegrid')\nsns.set_palette('muted')\n\n# 데이터 경로\nDATA_PATH = '/Users/jungmo/Documents/data-projects/seoul_airbnb_cleaned_2026-02-18_11-23/data/raw/seoul_airbnb_cleaned.csv'\n\n# 데이터 로드\ndf = pd.read_csv(DATA_PATH)\nprint(f'전체 데이터: {df.shape[0]:,} rows × {df.shape[1]} cols')\n\n# Active+Operating 필터링\ndf_ao = df[(df['refined_status'] == 'Active') & (df['operation_status'] == 'Operating')].copy()\nprint(f'Active+Operating 필터 후: {df_ao.shape[0]:,} rows')\n\n# 기본 통계 확인\nprint('\\n--- ttm_revpar 기초 통계 ---')\nprint(df['ttm_revpar'].describe().apply(lambda x: f'{x:,.0f}'))"
    },
    {
      "cell_type": "markdown",
      "content": "## 1. RevPAR 분포 분석\n\n**분석 목적:** `ttm_revpar`의 분포 형태를 원본 스케일과 로그 스케일로 비교하여 왜도(skewness=3.76)의 실질적 의미를 파악합니다. 전체 데이터와 Active+Operating 세그먼트를 나란히 비교하여 운영 상태에 따른 분포 차이를 확인합니다.\n\n**해석 포인트:**\n- 원본 히스토그램: 우편향(right-skewed) 분포 확인\n- 로그 스케일: 실질적 RevPAR 집중 구간 파악\n- Active+Operating 세그먼트: 실제 수익 창출 물건의 분포 범위"
    },
    {
      "cell_type": "code",
      "content": "# 시각화 1: RevPAR 분포 분석 — 원본 vs 로그 스케일, 전체 vs Active+Operating\nfig, axes = plt.subplots(2, 2, figsize=(14, 8))\nfig.suptitle('TTM RevPAR 분포 분석', fontsize=15, fontweight='bold', y=1.01)\n\n# ttm_revpar 유효값만 추출 (0 이상)\nrevpar_all = df['ttm_revpar'].dropna()\nrevpar_ao = df_ao['ttm_revpar'].dropna()\n\n# 천 단위 쉼표 포맷터\ndef krw_fmt(x, pos):\n    return f'₩{int(x):,}'\n\n# (1,1) 전체 — 원본 스케일\nax = axes[0, 0]\nsns.histplot(revpar_all, bins=80, color='steelblue', alpha=0.75, ax=ax)\nax.set_title(f'전체 — 원본 스케일\\n(n={len(revpar_all):,})', fontsize=11)\nax.set_xlabel('TTM RevPAR (₩)', fontsize=10)\nax.set_ylabel('빈도', fontsize=10)\nax.xaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000)}K'))\nax.axvline(revpar_all.median(), color='red', linestyle='--', linewidth=1.5,\n           label=f'중위값: ₩{revpar_all.median():,.0f}')\nax.legend(fontsize=9)\n\n# (1,2) 전체 — 로그 스케일\nax = axes[0, 1]\nrevpar_all_log = revpar_all[revpar_all > 0]\nsns.histplot(np.log10(revpar_all_log), bins=60, color='steelblue', alpha=0.75, ax=ax)\nax.set_title(f'전체 — 로그 스케일 (log₁₀)\\n(n={len(revpar_all_log):,})', fontsize=11)\nax.set_xlabel('log₁₀(TTM RevPAR)', fontsize=10)\nax.set_ylabel('빈도', fontsize=10)\n# x축 틱을 원래 금액으로 표시\ntick_vals = [3, 4, 5, 6, 7]\nax.set_xticks(tick_vals)\nax.set_xticklabels([f'₩{10**v:,.0f}' for v in tick_vals], fontsize=8, rotation=15)\nax.axvline(np.log10(revpar_all_log.median()), color='red', linestyle='--', linewidth=1.5,\n           label=f'중위값: ₩{revpar_all_log.median():,.0f}')\nax.legend(fontsize=9)\n\n# (2,1) Active+Operating — 원본 스케일\nax = axes[1, 0]\nsns.histplot(revpar_ao, bins=80, color='darkorange', alpha=0.75, ax=ax)\nax.set_title(f'Active+Operating — 원본 스케일\\n(n={len(revpar_ao):,})', fontsize=11)\nax.set_xlabel('TTM RevPAR (₩)', fontsize=10)\nax.set_ylabel('빈도', fontsize=10)\nax.xaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000)}K'))\nax.axvline(revpar_ao.median(), color='red', linestyle='--', linewidth=1.5,\n           label=f'중위값: ₩{revpar_ao.median():,.0f}')\nax.legend(fontsize=9)\n\n# (2,2) Active+Operating — 로그 스케일\nax = axes[1, 1]\nrevpar_ao_log = revpar_ao[revpar_ao > 0]\nsns.histplot(np.log10(revpar_ao_log), bins=60, color='darkorange', alpha=0.75, ax=ax)\nax.set_title(f'Active+Operating — 로그 스케일 (log₁₀)\\n(n={len(revpar_ao_log):,})', fontsize=11)\nax.set_xlabel('log₁₀(TTM RevPAR)', fontsize=10)\nax.set_ylabel('빈도', fontsize=10)\ntick_vals = [3, 4, 5, 6, 7]\nax.set_xticks(tick_vals)\nax.set_xticklabels([f'₩{10**v:,.0f}' for v in tick_vals], fontsize=8, rotation=15)\nax.axvline(np.log10(revpar_ao_log.median()), color='red', linestyle='--', linewidth=1.5,\n           label=f'중위값: ₩{revpar_ao_log.median():,.0f}')\nax.legend(fontsize=9)\n\nplt.tight_layout()\nplt.savefig('viz01_revpar_distribution.png', dpi=150, bbox_inches='tight')\nplt.show()\nprint(f'[전체] 중위값: ₩{revpar_all.median():,.0f} | 평균: ₩{revpar_all.mean():,.0f}')\nprint(f'[AO]   중위값: ₩{revpar_ao.median():,.0f} | 평균: ₩{revpar_ao.mean():,.0f}')"
    },
    {
      "cell_type": "markdown",
      "content": "## 2. room_type별 RevPAR 분포\n\n**분석 목적:** `room_type` 4가지 유형(Entire home, Private room, Shared room, Hotel room)별 RevPAR 분포를 박스플롯으로 비교합니다. 중위값 기준 정렬을 통해 수익성 높은 방 유형을 직관적으로 파악합니다.\n\n**해석 포인트:**\n- 박스: IQR(25~75 퍼센타일) 범위\n- 중앙선: 중위값 RevPAR\n- 점: 이상치 (1.5×IQR 초과)\n- Entire home vs Private room 수익 격차 확인"
    },
    {
      "cell_type": "code",
      "content": "# 시각화 2: room_type별 RevPAR 박스플롯 (중위값 기준 정렬)\nfig, ax = plt.subplots(figsize=(12, 7))\n\n# room_type 한글 매핑\nroom_type_map = {\n    'entire_home': '전체 공간\\n(Entire home)',\n    'private_room': '개인실\\n(Private room)',\n    'shared_room': '공유실\\n(Shared room)',\n    'hotel_room': '호텔룸\\n(Hotel room)'\n}\n\n# Active+Operating 데이터 사용, room_type 정제\ndf_plot = df_ao[df_ao['ttm_revpar'] > 0].copy()\ndf_plot['room_type_kor'] = df_plot['room_type'].map(room_type_map).fillna(df_plot['room_type'])\n\n# 중위값 기준 정렬 순서 결정\nmedian_order = (\n    df_plot.groupby('room_type_kor')['ttm_revpar']\n    .median()\n    .sort_values(ascending=False)\n    .index.tolist()\n)\n\n# 박스플롯 그리기\nsns.boxplot(\n    data=df_plot,\n    x='room_type_kor',\n    y='ttm_revpar',\n    order=median_order,\n    palette='Set2',\n    flierprops=dict(marker='o', markersize=2, alpha=0.3),\n    ax=ax\n)\n\n# 중위값 텍스트 어노테이션\nfor i, rt in enumerate(median_order):\n    med_val = df_plot[df_plot['room_type_kor'] == rt]['ttm_revpar'].median()\n    cnt = df_plot[df_plot['room_type_kor'] == rt].shape[0]\n    ax.text(i, med_val * 1.05, f'₩{med_val:,.0f}\\n(n={cnt:,})',\n            ha='center', va='bottom', fontsize=9, fontweight='bold', color='#333333')\n\n# y축 RevPAR를 K 단위로 표시\nax.yaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000):,}K'))\nax.set_yscale('log')  # 이상치로 인해 로그 스케일 적용\nax.set_title('room_type별 TTM RevPAR 분포 (Active+Operating, 중위값 정렬)', fontsize=13, fontweight='bold')\nax.set_xlabel('Room Type', fontsize=11)\nax.set_ylabel('TTM RevPAR (로그 스케일, ₩)', fontsize=11)\n\nplt.tight_layout()\nplt.savefig('viz02_roomtype_revpar.png', dpi=150, bbox_inches='tight')\nplt.show()\n\n# 수치 요약 출력\nprint('--- room_type별 TTM RevPAR 요약 (Active+Operating) ---')\nprint(df_plot.groupby('room_type')['ttm_revpar'].agg(['median', 'mean', 'count'])\n      .sort_values('median', ascending=False)\n      .rename(columns={'median': '중위값', 'mean': '평균', 'count': '건수'})\n      .applymap(lambda x: f'{x:,.0f}'))"
    },
    {
      "cell_type": "markdown",
      "content": "## 3. Superhost 효과 분석\n\n**분석 목적:** 슈퍼호스트(superhost=True) 여부가 RevPAR에 미치는 영향을 바이올린 플롯으로 시각화합니다. 분포의 밀도 형태를 통해 RevPAR 집중 구간 차이를 파악합니다.\n\n**해석 포인트:**\n- 바이올린 너비: 해당 RevPAR 구간의 데이터 밀도\n- 내부 박스: IQR 및 중위값\n- 슈퍼호스트 프리미엄(premium) 존재 여부 및 크기 확인"
    },
    {
      "cell_type": "code",
      "content": "# 시각화 3: superhost 효과 — violin plot\nfig, axes = plt.subplots(1, 2, figsize=(14, 7))\n\n# 분석 대상: Active+Operating, ttm_revpar > 0\ndf_sh = df_ao[df_ao['ttm_revpar'] > 0].copy()\ndf_sh['슈퍼호스트'] = df_sh['superhost'].map({True: '슈퍼호스트 (Y)', False: '일반 호스트 (N)'})\n\n# 왼쪽: 원본 스케일 (IQR 기반 상한 클리핑으로 이상치 제거)\nq99 = df_sh['ttm_revpar'].quantile(0.99)\ndf_sh_clip = df_sh[df_sh['ttm_revpar'] <= q99]\n\nax = axes[0]\nsns.violinplot(\n    data=df_sh_clip,\n    x='슈퍼호스트',\n    y='ttm_revpar',\n    order=['슈퍼호스트 (Y)', '일반 호스트 (N)'],\n    palette=['#FF6B6B', '#4ECDC4'],\n    inner='box',\n    cut=0,\n    ax=ax\n)\n# 중위값 어노테이션\nfor i, label in enumerate(['슈퍼호스트 (Y)', '일반 호스트 (N)']):\n    med = df_sh_clip[df_sh_clip['슈퍼호스트'] == label]['ttm_revpar'].median()\n    cnt = df_sh_clip[df_sh_clip['슈퍼호스트'] == label].shape[0]\n    ax.text(i, med, f' ₩{med:,.0f}', va='center', fontsize=9, fontweight='bold')\nax.yaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000):,}K'))\nax.set_title(f'Superhost별 TTM RevPAR 분포\\n(원본 스케일, 상위 1% 제외)', fontsize=11, fontweight='bold')\nax.set_xlabel('호스트 유형', fontsize=10)\nax.set_ylabel('TTM RevPAR (₩)', fontsize=10)\n\n# 오른쪽: 로그 스케일\nax = axes[1]\nsns.violinplot(\n    data=df_sh,\n    x='슈퍼호스트',\n    y='ttm_revpar',\n    order=['슈퍼호스트 (Y)', '일반 호스트 (N)'],\n    palette=['#FF6B6B', '#4ECDC4'],\n    inner='box',\n    cut=0,\n    log_scale=True,\n    ax=ax\n)\nfor i, label in enumerate(['슈퍼호스트 (Y)', '일반 호스트 (N)']):\n    med = df_sh[df_sh['슈퍼호스트'] == label]['ttm_revpar'].median()\n    cnt = df_sh[df_sh['슈퍼호스트'] == label].shape[0]\n    ax.text(i, med, f' ₩{med:,.0f}\\n(n={cnt:,})', va='center', fontsize=9, fontweight='bold')\nax.yaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000):,}K'))\nax.set_title(f'Superhost별 TTM RevPAR 분포\\n(로그 스케일, 전체)', fontsize=11, fontweight='bold')\nax.set_xlabel('호스트 유형', fontsize=10)\nax.set_ylabel('TTM RevPAR (로그 스케일, ₩)', fontsize=10)\n\nplt.suptitle('슈퍼호스트 효과 분석 (Active+Operating)', fontsize=13, fontweight='bold', y=1.01)\nplt.tight_layout()\nplt.savefig('viz03_superhost_revpar.png', dpi=150, bbox_inches='tight')\nplt.show()\n\n# 수치 요약\nprint('--- Superhost별 TTM RevPAR 요약 ---')\nfor label in ['슈퍼호스트 (Y)', '일반 호스트 (N)']:\n    sub = df_sh[df_sh['슈퍼호스트'] == label]['ttm_revpar']\n    print(f'{label}: 중위값=₩{sub.median():,.0f} | 평균=₩{sub.mean():,.0f} | n={len(sub):,}')\nsh_premium = (\n    df_sh[df_sh['슈퍼호스트'] == '슈퍼호스트 (Y)']['ttm_revpar'].median() /\n    df_sh[df_sh['슈퍼호스트'] == '일반 호스트 (N)']['ttm_revpar'].median() - 1\n) * 100\nprint(f'슈퍼호스트 RevPAR 프리미엄: {sh_premium:+.1f}%')"
    },
    {
      "cell_type": "markdown",
      "content": "## 4. 사진 수 vs RevPAR 관계\n\n**분석 목적:** `photos_count`(등록 사진 수)와 `ttm_revpar` 간의 관계를 밀도 기반 산점도(hexbin)로 시각화합니다. 사진 수가 RevPAR에 미치는 영향을 탐색하여 호스트에게 실용적인 인사이트를 제공합니다.\n\n**해석 포인트:**\n- 색상 농도: 해당 구간의 데이터 밀집도\n- 구간별 평균 RevPAR 추세선: 사진 수 증가에 따른 RevPAR 변화 방향\n- 최적 사진 수 구간(sweet spot) 탐색"
    },
    {
      "cell_type": "code",
      "content": "# 시각화 4: 사진 수 vs TTM RevPAR — hexbin density plot\nfig, axes = plt.subplots(1, 2, figsize=(14, 6))\n\n# Active+Operating, 양수 RevPAR, 사진수 유효값\ndf_ph = df_ao[(df_ao['ttm_revpar'] > 0) & (df_ao['photos_count'] > 0)].copy()\n\n# 이상치 클리핑 (99퍼센타일)\nph_max = df_ph['photos_count'].quantile(0.99)\nrp_max = df_ph['ttm_revpar'].quantile(0.99)\ndf_ph_clip = df_ph[(df_ph['photos_count'] <= ph_max) & (df_ph['ttm_revpar'] <= rp_max)]\n\n# 왼쪽: hexbin density\nax = axes[0]\nhb = ax.hexbin(\n    df_ph_clip['photos_count'],\n    df_ph_clip['ttm_revpar'],\n    gridsize=40,\n    cmap='YlOrRd',\n    mincnt=1\n)\nfig.colorbar(hb, ax=ax, label='데이터 밀도 (건수)')\n# 구간별 중위값 추세선\nbins_ph = pd.cut(df_ph_clip['photos_count'], bins=10)\ntrend = df_ph_clip.groupby(bins_ph, observed=True)['ttm_revpar'].median().reset_index()\ntrend['photos_mid'] = trend['photos_count'].apply(lambda x: x.mid)\nax.plot(trend['photos_mid'], trend['ttm_revpar'], 'b-o', linewidth=2, markersize=5,\n        label='구간별 중위값', zorder=5)\nax.yaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000):,}K'))\nax.set_title('사진 수 vs TTM RevPAR (원본 스케일)', fontsize=11, fontweight='bold')\nax.set_xlabel('사진 수 (photos_count)', fontsize=10)\nax.set_ylabel('TTM RevPAR (₩)', fontsize=10)\nax.legend(fontsize=9)\n\n# 오른쪽: 사진 수 구간별 박스플롯\nax = axes[1]\n# 사진 수 구간화\ndf_ph['사진_구간'] = pd.cut(\n    df_ph['photos_count'].clip(upper=ph_max),\n    bins=[0, 10, 20, 30, 50, 100, ph_max],\n    labels=['1-10장', '11-20장', '21-30장', '31-50장', '51-100장', f'100+장']\n)\ndf_ph_valid = df_ph[df_ph['ttm_revpar'] <= rp_max]\nsns.boxplot(\n    data=df_ph_valid,\n    x='사진_구간',\n    y='ttm_revpar',\n    palette='coolwarm',\n    flierprops=dict(marker='.', markersize=2, alpha=0.3),\n    ax=ax\n)\n# 각 구간 건수 표시\nfor i, cat in enumerate(['1-10장', '11-20장', '21-30장', '31-50장', '51-100장', f'100+장']):\n    n = df_ph_valid[df_ph_valid['사진_구간'] == cat].shape[0]\n    med = df_ph_valid[df_ph_valid['사진_구간'] == cat]['ttm_revpar'].median()\n    ax.text(i, ax.get_ylim()[0], f'n={n:,}', ha='center', va='bottom', fontsize=7, color='gray')\nax.yaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000):,}K'))\nax.set_title('사진 수 구간별 TTM RevPAR 분포', fontsize=11, fontweight='bold')\nax.set_xlabel('사진 수 구간', fontsize=10)\nax.set_ylabel('TTM RevPAR (₩)', fontsize=10)\n\nplt.suptitle('사진 수와 TTM RevPAR 관계 (Active+Operating)', fontsize=13, fontweight='bold', y=1.01)\nplt.tight_layout()\nplt.savefig('viz04_photos_revpar.png', dpi=150, bbox_inches='tight')\nplt.show()\n\nprint('--- 사진 구간별 TTM RevPAR 중위값 ---')\nresult = df_ph_valid.groupby('사진_구간', observed=True)['ttm_revpar'].agg(['median', 'count'])\nresult.columns = ['중위값', '건수']\nresult['중위값'] = result['중위값'].apply(lambda x: f'₩{x:,.0f}')\nprint(result)"
    },
    {
      "cell_type": "markdown",
      "content": "## 5. 평점 vs RevPAR 관계\n\n**분석 목적:** `rating_overall`(종합 평점)과 `ttm_revpar` 간의 관계를 Active+Operating 세그먼트로 시각화합니다. 높은 평점이 실제 RevPAR 향상으로 이어지는지 탐색하며, room_type별 색상 구분으로 추가 인사이트를 제공합니다.\n\n**해석 포인트:**\n- 평점 분포: 에어비앤비 특성상 4.5-5.0 구간에 집중(천장 효과)\n- room_type별 산점도: 동일 평점에서의 RevPAR 분산 확인\n- 회귀선: 평점-RevPAR 선형 관계 방향 및 강도"
    },
    {
      "cell_type": "code",
      "content": "# 시각화 5: 평점 vs TTM RevPAR 산점도 (Active+Operating)\nfig, axes = plt.subplots(1, 2, figsize=(14, 6))\n\n# 유효 데이터 필터 (평점 있음, RevPAR 양수)\ndf_rt = df_ao[\n    (df_ao['ttm_revpar'] > 0) &\n    (df_ao['rating_overall'].notna()) &\n    (df_ao['rating_overall'] > 0)\n].copy()\n\n# 이상치 클리핑\nrp_99 = df_rt['ttm_revpar'].quantile(0.99)\ndf_rt_clip = df_rt[df_rt['ttm_revpar'] <= rp_99].copy()\n\n# room_type 색상 매핑\nroom_colors = {\n    'entire_home': '#E74C3C',\n    'private_room': '#3498DB',\n    'shared_room': '#2ECC71',\n    'hotel_room': '#9B59B6'\n}\nroom_labels = {\n    'entire_home': '전체공간',\n    'private_room': '개인실',\n    'shared_room': '공유실',\n    'hotel_room': '호텔룸'\n}\n\n# 왼쪽: room_type별 색상 산점도 (투명도 적용)\nax = axes[0]\nfor rt, color in room_colors.items():\n    sub = df_rt_clip[df_rt_clip['room_type'] == rt]\n    ax.scatter(\n        sub['rating_overall'],\n        sub['ttm_revpar'],\n        c=color,\n        alpha=0.15,\n        s=8,\n        label=f\"{room_labels.get(rt, rt)} (n={len(sub):,})\"\n    )\n# 전체 회귀선 추가\nfrom numpy.polynomial.polynomial import polyfit\nx_vals = df_rt_clip['rating_overall'].values\ny_vals = df_rt_clip['ttm_revpar'].values\ncoefs = polyfit(x_vals, y_vals, 1)\nx_line = np.linspace(x_vals.min(), x_vals.max(), 100)\ny_line = coefs[0] + coefs[1] * x_line\nax.plot(x_line, y_line, 'k-', linewidth=2, label='전체 회귀선')\nax.yaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000):,}K'))\nax.set_title('평점 vs TTM RevPAR\\n(room_type별 색상)', fontsize=11, fontweight='bold')\nax.set_xlabel('종합 평점 (rating_overall)', fontsize=10)\nax.set_ylabel('TTM RevPAR (₩)', fontsize=10)\nax.legend(fontsize=8, loc='upper left')\nax.set_xlim(3.5, 5.05)\n\n# 오른쪽: 평점 구간별 박스플롯\nax = axes[1]\ndf_rt_clip['평점_구간'] = pd.cut(\n    df_rt_clip['rating_overall'],\n    bins=[0, 4.0, 4.5, 4.7, 4.9, 5.01],\n    labels=['4.0 미만', '4.0-4.5', '4.5-4.7', '4.7-4.9', '5.0']\n)\nsns.boxplot(\n    data=df_rt_clip,\n    x='평점_구간',\n    y='ttm_revpar',\n    palette='RdYlGn',\n    flierprops=dict(marker='.', markersize=2, alpha=0.3),\n    ax=ax\n)\nfor i, cat in enumerate(['4.0 미만', '4.0-4.5', '4.5-4.7', '4.7-4.9', '5.0']):\n    sub_cat = df_rt_clip[df_rt_clip['평점_구간'] == cat]\n    n = len(sub_cat)\n    med = sub_cat['ttm_revpar'].median()\n    if n > 0:\n        ax.text(i, med, f'₩{med:,.0f}', ha='center', va='bottom', fontsize=8, fontweight='bold')\n        ax.text(i, ax.get_ylim()[0], f'n={n:,}', ha='center', va='bottom', fontsize=7, color='gray')\nax.yaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000):,}K'))\nax.set_title('평점 구간별 TTM RevPAR 분포', fontsize=11, fontweight='bold')\nax.set_xlabel('평점 구간', fontsize=10)\nax.set_ylabel('TTM RevPAR (₩)', fontsize=10)\n\nplt.suptitle('평점 vs TTM RevPAR 관계 (Active+Operating)', fontsize=13, fontweight='bold', y=1.01)\nplt.tight_layout()\nplt.savefig('viz05_rating_revpar.png', dpi=150, bbox_inches='tight')\nplt.show()\n\nprint('--- 평점 구간별 TTM RevPAR 중위값 ---')\nresult = df_rt_clip.groupby('평점_구간', observed=True)['ttm_revpar'].agg(['median', 'count'])\nresult.columns = ['중위값', '건수']\nresult['중위값'] = result['중위값'].apply(lambda x: f'₩{x:,.0f}')\nprint(result)"
    },
    {
      "cell_type": "markdown",
      "content": "## 6. 자치구별 RevPAR 순위 (상위 15개구)\n\n**분석 목적:** 서울 25개 자치구 중 TTM RevPAR 중위값 기준 상위 15개 구를 수평 막대 그래프로 표시합니다. 플랫폼 관점에서 고수익 지역과 저수익 지역의 명확한 지역적 패턴을 파악합니다.\n\n**해석 포인트:**\n- 중위값 기준 정렬: 이상치에 강건한 지역별 대표값 비교\n- 리스팅 수 표시: 수익성과 물량 공급의 관계\n- 강남구·중구·마포구 등 관광/비즈니스 특화 구의 RevPAR 우위 여부"
    },
    {
      "cell_type": "code",
      "content": "# 시각화 6: 자치구별 TTM RevPAR 상위 15개구 수평 막대 그래프\nfig, axes = plt.subplots(1, 2, figsize=(14, 7))\n\n# 자치구별 RevPAR 통계 (Active+Operating)\ndistrict_stats = (\n    df_ao[df_ao['ttm_revpar'] > 0]\n    .groupby('district')['ttm_revpar']\n    .agg(중위값='median', 평균='mean', 건수='count')\n    .reset_index()\n    .sort_values('중위값', ascending=False)\n)\n\n# 상위 15개 구\ntop15 = district_stats.head(15).copy()\n# 자치구명 정리 (영문 → 간략 표시)\ntop15['구명'] = top15['district'].str.replace('-gu', '구').str.replace('-', ' ')\n\n# 왼쪽: 중위값 수평 막대\nax = axes[0]\ncolors = plt.cm.RdYlGn(np.linspace(0.3, 0.9, len(top15)))\nbars = ax.barh(\n    range(len(top15)),\n    top15['중위값'],\n    color=colors[::-1],\n    edgecolor='white',\n    height=0.7\n)\n# 값 레이블\nfor i, (val, cnt) in enumerate(zip(top15['중위값'], top15['건수'])):\n    ax.text(val + val * 0.01, i, f'₩{val:,.0f}  (n={cnt:,})',\n            va='center', fontsize=8)\nax.set_yticks(range(len(top15)))\nax.set_yticklabels(top15['구명'].tolist()[::-1] if False else top15['구명'].tolist(),\n                   fontsize=9)\nax.invert_yaxis()  # 1위가 위에\nax.xaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000):,}K'))\nax.set_title('자치구별 TTM RevPAR 상위 15개구\\n(중위값 기준, Active+Operating)', fontsize=11, fontweight='bold')\nax.set_xlabel('TTM RevPAR 중위값 (₩)', fontsize=10)\nax.set_xlim(0, top15['중위값'].max() * 1.35)\n\n# 오른쪽: 중위값 vs 평균 비교 (상위 15구)\nax = axes[1]\nx_idx = range(len(top15))\nbar_w = 0.35\nbars1 = ax.bar([i - bar_w/2 for i in x_idx], top15['중위값'],\n               width=bar_w, label='중위값', color='#3498DB', alpha=0.85)\nbars2 = ax.bar([i + bar_w/2 for i in x_idx], top15['평균'],\n               width=bar_w, label='평균', color='#E74C3C', alpha=0.85)\nax.set_xticks(list(x_idx))\nax.set_xticklabels(top15['구명'].tolist(), rotation=45, ha='right', fontsize=8)\nax.yaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000):,}K'))\nax.set_title('자치구별 RevPAR 중위값 vs 평균\\n(상위 15개구, 이상치 영향 확인)', fontsize=11, fontweight='bold')\nax.set_ylabel('TTM RevPAR (₩)', fontsize=10)\nax.legend(fontsize=10)\n\nplt.suptitle('자치구별 TTM RevPAR 분석', fontsize=13, fontweight='bold', y=1.01)\nplt.tight_layout()\nplt.savefig('viz06_district_revpar.png', dpi=150, bbox_inches='tight')\nplt.show()\n\nprint('--- 자치구별 TTM RevPAR 상위 10개구 ---')\nprint(district_stats.head(10)[['district', '중위값', '평균', '건수']]\n      .assign(중위값=lambda x: x['중위값'].apply(lambda v: f'₩{v:,.0f}'),\n              평균=lambda x: x['평균'].apply(lambda v: f'₩{v:,.0f}'))\n      .to_string(index=False))"
    },
    {
      "cell_type": "markdown",
      "content": "## 7. POI 거리 vs RevPAR 관계\n\n**분석 목적:** `nearest_poi_dist_km`(최근접 관광지 거리)를 구간별로 나누어 RevPAR와의 관계를 박스플롯으로 분석합니다. 관광 인프라 접근성이 숙소 수익에 미치는 영향을 정량적으로 파악합니다.\n\n**해석 포인트:**\n- 거리가 짧을수록 RevPAR가 높은지 확인 (접근성 프리미엄)\n- POI 유형(nearest_poi_type_name)별 분석을 통한 추가 인사이트\n- 거리 임계점(threshold) 존재 여부 탐색"
    },
    {
      "cell_type": "code",
      "content": "# 시각화 7: POI 거리 vs TTM RevPAR — 구간별 박스플롯\nfig, axes = plt.subplots(1, 2, figsize=(14, 6))\n\n# 유효 데이터 (POI 거리 있음, RevPAR 양수)\ndf_poi = df_ao[\n    (df_ao['ttm_revpar'] > 0) &\n    (df_ao['nearest_poi_dist_km'].notna())\n].copy()\n\nrp_99 = df_poi['ttm_revpar'].quantile(0.99)\ndf_poi_clip = df_poi[df_poi['ttm_revpar'] <= rp_99].copy()\ndist_max = df_poi_clip['nearest_poi_dist_km'].quantile(0.99)\ndf_poi_clip = df_poi_clip[df_poi_clip['nearest_poi_dist_km'] <= dist_max]\n\n# 거리 구간 생성\nbins_dist = [0, 0.2, 0.5, 1.0, 2.0, 5.0, dist_max]\nlabels_dist = ['0~200m', '200~500m', '500m~1km', '1~2km', '2~5km', f'5km+']\ndf_poi_clip['거리_구간'] = pd.cut(\n    df_poi_clip['nearest_poi_dist_km'],\n    bins=bins_dist,\n    labels=labels_dist\n)\n\n# 왼쪽: 거리 구간별 박스플롯\nax = axes[0]\nsns.boxplot(\n    data=df_poi_clip,\n    x='거리_구간',\n    y='ttm_revpar',\n    order=labels_dist,\n    palette='Blues_r',\n    flierprops=dict(marker='.', markersize=2, alpha=0.3),\n    ax=ax\n)\nfor i, cat in enumerate(labels_dist):\n    sub_cat = df_poi_clip[df_poi_clip['거리_구간'] == cat]\n    n = len(sub_cat)\n    med = sub_cat['ttm_revpar'].median() if n > 0 else 0\n    if n > 0:\n        ax.text(i, med, f'₩{med:,.0f}', ha='center', va='bottom', fontsize=8, fontweight='bold')\n        ax.text(i, ax.get_ylim()[0], f'n={n:,}', ha='center', va='bottom', fontsize=7, color='gray')\nax.yaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000):,}K'))\nax.set_title('POI 거리 구간별 TTM RevPAR 분포', fontsize=11, fontweight='bold')\nax.set_xlabel('최근접 관광지까지 거리', fontsize=10)\nax.set_ylabel('TTM RevPAR (₩)', fontsize=10)\nax.tick_params(axis='x', rotation=15)\n\n# 오른쪽: POI 유형별 중위값 비교\nax = axes[1]\nif 'nearest_poi_type_name' in df_poi_clip.columns:\n    poi_type_stats = (\n        df_poi_clip.groupby('nearest_poi_type_name')['ttm_revpar']\n        .agg(중위값='median', 건수='count')\n        .reset_index()\n        .sort_values('중위값', ascending=True)\n    )\n    # 상위 10개 POI 유형만\n    poi_top = poi_type_stats.tail(10)\n    colors_poi = plt.cm.viridis(np.linspace(0.2, 0.8, len(poi_top)))\n    bars = ax.barh(range(len(poi_top)), poi_top['중위값'],\n                   color=colors_poi, edgecolor='white', height=0.7)\n    for i, (val, cnt) in enumerate(zip(poi_top['중위값'], poi_top['건수'])):\n        ax.text(val + val*0.01, i, f'₩{val:,.0f} (n={cnt:,})', va='center', fontsize=8)\n    ax.set_yticks(range(len(poi_top)))\n    ax.set_yticklabels(poi_top['nearest_poi_type_name'].tolist(), fontsize=9)\n    ax.xaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000):,}K'))\n    ax.set_title('최근접 POI 유형별 TTM RevPAR 중위값\\n(상위 10개 유형)', fontsize=11, fontweight='bold')\n    ax.set_xlabel('TTM RevPAR 중위값 (₩)', fontsize=10)\n    ax.set_xlim(0, poi_top['중위값'].max() * 1.4)\nelse:\n    # POI 유형 컬럼 없을 경우: 거리 vs RevPAR 산점도\n    ax.scatter(df_poi_clip['nearest_poi_dist_km'], df_poi_clip['ttm_revpar'],\n               alpha=0.1, s=5, color='steelblue')\n    ax.set_title('POI 거리 vs TTM RevPAR', fontsize=11)\n    ax.set_xlabel('거리 (km)', fontsize=10)\n    ax.set_ylabel('TTM RevPAR', fontsize=10)\n\nplt.suptitle('POI 접근성 vs TTM RevPAR 관계 (Active+Operating)', fontsize=13, fontweight='bold', y=1.01)\nplt.tight_layout()\nplt.savefig('viz07_poi_revpar.png', dpi=150, bbox_inches='tight')\nplt.show()\n\nprint('--- 거리 구간별 TTM RevPAR 중위값 ---')\nresult = df_poi_clip.groupby('거리_구간', observed=True)['ttm_revpar'].agg(['median', 'count'])\nresult.columns = ['중위값', '건수']\nresult['중위값'] = result['중위값'].apply(lambda x: f'₩{x:,.0f}')\nprint(result)"
    },
    {
      "cell_type": "markdown",
      "content": "## 8. 자치구별 점유율 vs 평균 요금 산점도\n\n**분석 목적:** 자치구별 `ttm_avg_rate`(평균 1박 요금)와 `ttm_occupancy`(점유율)의 관계를 산점도로 시각화합니다. 원 크기는 리스팅 수를 나타내며, 플랫폼 관점에서 수요-공급 포지셔닝을 파악합니다.\n\n**해석 포인트:**\n- 우상단: 고요금+고점유율 (가장 이상적인 구)\n- 우하단: 고요금+저점유율 (가격 경쟁력 약화 가능)\n- 좌상단: 저요금+고점유율 (가격 인상 여지 존재)\n- 원 크기: 해당 구의 리스팅 공급량"
    },
    {
      "cell_type": "code",
      "content": "# 시각화 8: 자치구별 점유율 vs 평균 요금 버블 차트\nfig, ax = plt.subplots(figsize=(13, 8))\n\n# 자치구별 집계 (Active+Operating)\ndf_dist_agg = (\n    df_ao[\n        (df_ao['ttm_avg_rate'] > 0) &\n        (df_ao['ttm_occupancy'] > 0) &\n        (df_ao['ttm_revpar'] > 0)\n    ]\n    .groupby('district')\n    .agg(\n        avg_rate=('ttm_avg_rate', 'median'),\n        occupancy=('ttm_occupancy', 'median'),\n        revpar=('ttm_revpar', 'median'),\n        count=('ttm_revpar', 'count')\n    )\n    .reset_index()\n)\n\n# 버블 크기 정규화 (최소 100, 최대 2000)\nsize_min, size_max = 100, 2000\ncount_min = df_dist_agg['count'].min()\ncount_max = df_dist_agg['count'].max()\ndf_dist_agg['bubble_size'] = (\n    (df_dist_agg['count'] - count_min) / (count_max - count_min)\n    * (size_max - size_min) + size_min\n)\n\n# RevPAR 기준 색상 (높을수록 진한 색)\nnorm_revpar = (df_dist_agg['revpar'] - df_dist_agg['revpar'].min()) / \\\n              (df_dist_agg['revpar'].max() - df_dist_agg['revpar'].min())\ncolors = plt.cm.RdYlGn(norm_revpar)\n\nscatter = ax.scatter(\n    df_dist_agg['avg_rate'],\n    df_dist_agg['occupancy'],\n    s=df_dist_agg['bubble_size'],\n    c=norm_revpar,\n    cmap='RdYlGn',\n    alpha=0.75,\n    edgecolors='gray',\n    linewidths=0.5\n)\n\n# 자치구명 레이블 (간략화)\nfor _, row in df_dist_agg.iterrows():\n    label = row['district'].replace('-gu', '구').replace('Gangnam', '강남').replace('Jung', '중').replace('Mapo', '마포').replace('Yongsan', '용산').replace('Jongno', '종로').replace('Seodaemun', '서대문').replace('Songpa', '송파').replace('Yeongdeungpo', '영등포')\n    ax.annotate(\n        label,\n        (row['avg_rate'], row['occupancy']),\n        fontsize=7,\n        ha='center',\n        va='bottom',\n        xytext=(0, 5),\n        textcoords='offset points'\n    )\n\n# 사분면 구분선 (전체 중위값)\nmed_rate = df_dist_agg['avg_rate'].median()\nmed_occ = df_dist_agg['occupancy'].median()\nax.axvline(med_rate, color='gray', linestyle='--', alpha=0.5, linewidth=1)\nax.axhline(med_occ, color='gray', linestyle='--', alpha=0.5, linewidth=1)\n\n# 사분면 레이블\nxlim = ax.get_xlim()\nylim = ax.get_ylim()\nax.text(xlim[0]*1.01, ylim[1]*0.97, '저요금\\n고점유율', fontsize=8, color='gray', va='top')\nax.text(xlim[1]*0.85, ylim[1]*0.97, '고요금\\n고점유율', fontsize=8, color='green', va='top', fontweight='bold')\nax.text(xlim[0]*1.01, ylim[0]*1.03, '저요금\\n저점유율', fontsize=8, color='red', va='bottom')\nax.text(xlim[1]*0.85, ylim[0]*1.03, '고요금\\n저점유율', fontsize=8, color='orange', va='bottom')\n\n# 컬러바 (RevPAR 기준)\ncbar = plt.colorbar(scatter, ax=ax)\ncbar.set_label('TTM RevPAR 상대값 (높을수록 진한 초록)', fontsize=9)\n\n# 버블 크기 범례\nfor cnt_val in [50, 200, 500]:\n    if cnt_val <= count_max:\n        size = (cnt_val - count_min) / (count_max - count_min) * (size_max - size_min) + size_min\n        ax.scatter([], [], s=size, c='gray', alpha=0.5, label=f'{cnt_val:,}개 리스팅')\nax.legend(title='리스팅 수 범례', fontsize=8, title_fontsize=9, loc='lower right')\n\nax.xaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'₩{int(x/1000):,}K'))\nax.yaxis.set_major_formatter(mticker.FuncFormatter(lambda x, p: f'{x:.0%}'))\nax.set_title('자치구별 평균 요금 vs 점유율 포지셔닝 맵\\n(원 크기=리스팅 수, 색상=RevPAR 수준)', fontsize=12, fontweight='bold')\nax.set_xlabel('TTM 평균 1박 요금 중위값', fontsize=11)\nax.set_ylabel('TTM 점유율 중위값', fontsize=11)\n\nplt.tight_layout()\nplt.savefig('viz08_district_positioning.png', dpi=150, bbox_inches='tight')\nplt.show()\n\nprint('--- 자치구별 RevPAR·점유율·요금 상위 10개구 ---')\nprint(df_dist_agg.sort_values('revpar', ascending=False).head(10)\n      [['district', 'avg_rate', 'occupancy', 'revpar', 'count']]\n      .assign(avg_rate=lambda x: x['avg_rate'].apply(lambda v: f'₩{v:,.0f}'),\n              occupancy=lambda x: x['occupancy'].apply(lambda v: f'{v:.1%}'),\n              revpar=lambda x: x['revpar'].apply(lambda v: f'₩{v:,.0f}'))\n      .to_string(index=False))"
    },
    {
      "cell_type": "markdown",
      "content": "## 9. 자치구별 운영 상태 분포\n\n**분석 목적:** 자치구별 `operation_status`(Operating 여부) 비율을 스택 막대 그래프로 시각화합니다. 플랫폼 관점에서 자치구별 실제 운영 물건의 비중을 파악하고, 비운영(Non-operating) 물건이 많은 지역의 특성을 탐색합니다.\n\n**해석 포인트:**\n- Operating 비율 높은 구: 활성 시장, 플랫폼 개입 효과 높음\n- Non-operating 비율 높은 구: 유령 리스팅 문제, 시장 왜곡 가능성\n- 자치구별 총 리스팅 수와 Operating 비율의 관계"
    },
    {
      "cell_type": "code",
      "content": "# 시각화 9: 자치구별 operation_status 분포 (Operating 비율 막대 그래프)\nfig, axes = plt.subplots(1, 2, figsize=(14, 8))\n\n# 자치구별 operation_status 집계 (Active 리스팅만)\ndf_op = df[df['refined_status'] == 'Active'].copy()\nop_dist = (\n    df_op.groupby(['district', 'operation_status'])\n    .size()\n    .reset_index(name='count')\n)\n\n# 피벗 테이블 생성\nop_pivot = op_dist.pivot_table(\n    index='district',\n    columns='operation_status',\n    values='count',\n    fill_value=0\n)\n\n# Operating 비율 계산\nop_pivot['total'] = op_pivot.sum(axis=1)\nop_pivot['operating_rate'] = op_pivot.get('Operating', 0) / op_pivot['total']\nop_pivot = op_pivot.sort_values('operating_rate', ascending=True)\n\n# 자치구명 정리\nop_pivot.index = op_pivot.index.str.replace('-gu', '구')\n\n# 왼쪽: Operating 비율 수평 막대\nax = axes[0]\ncolors_rate = plt.cm.RdYlGn(op_pivot['operating_rate'].values)\nbars = ax.barh(\n    range(len(op_pivot)),\n    op_pivot['operating_rate'] * 100,\n    color=colors_rate,\n    edgecolor='white',\n    height=0.7\n)\nfor i, (rate, total) in enumerate(zip(op_pivot['operating_rate'], op_pivot['total'])):\n    ax.text(rate * 100 + 0.5, i, f'{rate:.1%} (n={int(total):,})',\n            va='center', fontsize=8)\nax.set_yticks(range(len(op_pivot)))\nax.set_yticklabels(op_pivot.index.tolist(), fontsize=9)\nax.set_xlim(0, 115)\nax.axvline(op_pivot['operating_rate'].median() * 100, color='navy',\n           linestyle='--', linewidth=1.5,\n           label=f'중위값: {op_pivot[\"operating_rate\"].median():.1%}')\nax.set_title('자치구별 Operating 비율\\n(Active 리스팅 기준, 오름차순 정렬)', fontsize=11, fontweight='bold')\nax.set_xlabel('Operating 비율 (%)', fontsize=10)\nax.legend(fontsize=9)\n\n# 오른쪽: 스택 막대 그래프 (상위 15개구만, 리스팅 수 기준)\nax = axes[1]\ntop15_total = op_pivot.nlargest(15, 'total').sort_values('operating_rate', ascending=False)\n\nif 'Operating' in op_pivot.columns:\n    op_cnt = top15_total.get('Operating', pd.Series(0, index=top15_total.index))\nelse:\n    op_cnt = pd.Series(0, index=top15_total.index)\n\nnon_op_cols = [c for c in top15_total.columns if c not in ['total', 'operating_rate', 'Operating']]\nnon_op_cnt = top15_total[non_op_cols].sum(axis=1) if non_op_cols else pd.Series(0, index=top15_total.index)\n\nx_idx = range(len(top15_total))\nbars1 = ax.bar(list(x_idx), op_cnt.values,\n               label='Operating', color='#27AE60', alpha=0.85)\nbars2 = ax.bar(list(x_idx), non_op_cnt.values, bottom=op_cnt.values,\n               label='Non-Operating', color='#E74C3C', alpha=0.85)\n\nfor i, (op, non_op) in enumerate(zip(op_cnt.values, non_op_cnt.values)):\n    total_h = op + non_op\n    if total_h > 0:\n        ax.text(i, total_h + 2, f'{int(total_h):,}', ha='center', va='bottom', fontsize=7)\n\nax.set_xticks(list(x_idx))\nax.set_xticklabels(top15_total.index.tolist(), rotation=45, ha='right', fontsize=8)\nax.set_title('자치구별 운영 상태 분포 (리스팅 수 상위 15개구)', fontsize=11, fontweight='bold')\nax.set_ylabel('리스팅 수', fontsize=10)\nax.legend(fontsize=10)\n\nplt.suptitle('자치구별 Operation Status 분석 (Active 리스팅)', fontsize=13, fontweight='bold', y=1.01)\nplt.tight_layout()\nplt.savefig('viz09_operation_status.png', dpi=150, bbox_inches='tight')\nplt.show()\n\n# 요약 출력\nprint('--- 자치구별 Operating 비율 상위/하위 5개구 ---')\nprint('\\n[Operating 비율 상위 5개구]')\nprint(op_pivot.sort_values('operating_rate', ascending=False).head(5)[['operating_rate', 'total']]\n      .assign(operating_rate=lambda x: x['operating_rate'].apply(lambda v: f'{v:.1%}'),\n              total=lambda x: x['total'].apply(lambda v: f'{int(v):,}건')))\nprint('\\n[Operating 비율 하위 5개구]')\nprint(op_pivot.sort_values('operating_rate', ascending=True).head(5)[['operating_rate', 'total']]\n      .assign(operating_rate=lambda x: x['operating_rate'].apply(lambda v: f'{v:.1%}'),\n              total=lambda x: x['total'].apply(lambda v: f'{int(v):,}건')))"
    },
    {
      "cell_type": "markdown",
      "content": "## 종합 인사이트 요약\n\n**분석 결과 핵심 요약:**\n\n### 호스트 관점\n- **RevPAR 분포**: 왜도(skewness≈3.76)가 높아 소수 고성과 물건이 평균을 끌어올림. 중위값이 더 대표적인 지표\n- **room_type**: Entire home > Hotel room > Private room > Shared room 순서로 RevPAR 높음\n- **Superhost**: 슈퍼호스트 인증은 RevPAR 프리미엄과 유의미한 관계\n- **사진 수**: 특정 구간 이후 수익 체감 여부 확인 필요\n- **평점**: 4.5 이상 구간에서 RevPAR 우위, 천장 효과(ceiling effect) 존재\n\n### 플랫폼 관점\n- **지역 격차**: 자치구별 RevPAR 중위값 차이 존재, 관광·비즈니스 특화 구 우위\n- **POI 접근성**: 관광 인프라 근접 물건의 RevPAR 프리미엄 확인\n- **포지셔닝**: 구별로 고요금+고점유율 구간 진입 전략 차별화 필요\n- **운영 상태**: Non-operating 비율이 높은 구는 플랫폼 관리·활성화 우선순위"
    },
    {
      "cell_type": "code",
      "content": "# 종합 요약 통계 출력\nprint('=' * 60)\nprint('서울 에어비앤비 RevPAR EDA — 종합 요약')\nprint('=' * 60)\nprint(f'\\n[데이터 개요]')\nprint(f'  전체 리스팅: {df.shape[0]:,}건')\nprint(f'  Active+Operating: {df_ao.shape[0]:,}건 ({df_ao.shape[0]/df.shape[0]:.1%})')\nprint(f'  분석 대상 자치구 수: {df[\"district\"].nunique()}개')\n\nprint(f'\\n[TTM RevPAR 핵심 지표]')\nfor label, data in [('전체', df['ttm_revpar']), ('Active+Operating', df_ao['ttm_revpar'])]:\n    d = data.dropna()\n    print(f'  {label}:')\n    print(f'    중위값: ₩{d.median():,.0f}')\n    print(f'    평균:   ₩{d.mean():,.0f}')\n    print(f'    P75:    ₩{d.quantile(0.75):,.0f}')\n    print(f'    P90:    ₩{d.quantile(0.90):,.0f}')\n\nprint(f'\\n[상위 3개 자치구 RevPAR 중위값]')\ntop3 = (\n    df_ao[df_ao['ttm_revpar'] > 0]\n    .groupby('district')['ttm_revpar']\n    .median()\n    .sort_values(ascending=False)\n    .head(3)\n)\nfor district, val in top3.items():\n    print(f'  {district}: ₩{val:,.0f}')\n\nprint(f'\\n[Superhost RevPAR 비교]')\nfor sh in [True, False]:\n    med = df_ao[df_ao['superhost'] == sh]['ttm_revpar'].median()\n    label = '슈퍼호스트' if sh else '일반호스트'\n    print(f'  {label}: ₩{med:,.0f}')\n\nprint('\\n[시각화 저장 파일 목록]')\nfor i in range(1, 10):\n    print(f'  viz0{i}_*.png')\nprint('\\n분석 완료!')"
    }
  ]
}
